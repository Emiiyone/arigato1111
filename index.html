<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>ARIGATO!</title>
  <script src="js/jquery-2.1.3.min.js"></script>
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind:wght@400&display=swap" rel="stylesheet">
</head>

<body>
<div class="wrapper">
  <h1>ARIGATO!</h1>
  <h2>ã‚ã‚ŠãŒã¨ã†ã®æ³¢å‹•ã‚’å‡ºã—ã¦é‹æ°—ã‚’ä¸Šã’ã‚ˆã†</h2>
  <main>
    <div class="input-area">
      <input id="text" type="text" placeholder="ã‚ã‚ŠãŒã¨ã†ã‚’å…¥åŠ›">
    </div>
    <button id="videoPlay" onclick="readAloud()">ã‚ã‚ŠãŒã¨ã†ã®<br>æ³¢å‹•ã‚’å‡ºã™</button>
    <div class="list_btn_wrap">
      <button id="list_btn"><img src="list_btn.png" alt="ã‚ã‚ŠãŒã¨ã†ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹"></button>
    </div>
  </main>

<!-- å‹•ç”»&éŸ³ -->
  <div class="vid_contents">
    <video id="video">
      <source src="movie/Bollywood Crazy Dance _ from the movie Bajirao Mastani.mp4" type="video/mp4">
    </video>
    </div>
    <video id="audio">
      <source src="movie/nc78744.wav" type="audio/mp4">
    </video>

    <div class="keep">
      <button id="save" class="btnripple">ã‚ã‚ŠãŒã¨ã†ã‚’è²¯ã‚ã‚‹</button>
    </div>

    <div class="arigato_list">
        <ul id="list">
          <!-- ã“ã“ã«è¿½åŠ ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
        </ul>
      <div class="btn_area">
        <button id="list_btn_close" class="btnripple">ã‚ã‚ŠãŒã¨ã†ãƒªã‚¹ãƒˆã‚’é–‰ã˜ã‚‹</button>
        <button id="clear" class="btnripple">å…¨ã¦ã®ã‚ã‚ŠãŒã¨ã†ã‚’æ‰‹æ”¾ã™</button>
      </div>
  </div>
</div>


  
  <!-- ä»¥ä¸‹ã«jsã‚’æ›¸ã„ã¦ã„ãã¾ã™ -->
<script>

$('#list_btn').on( "click", function(){
    $('.arigato_list').fadeIn(1000);

      var target = $('#list li').length;
      if ( target === 0 ){
        $('#list').after('<div class="count" style="display: block;"><span>ã‚ã‚ŠãŒã¨ã†</span>ã¯ã‚ã‚Šã¾ã›ã‚“</div>');
      }
      else {
        $('#list').after('<div class="count" style="display: none;"></div>');
      }
      var size = $('.count').length;
      console.log(size);
       if ( size > 0 ){
        $('.count').eq(1).addClass('invisible-count'); 
      } 
})
  $('#list_btn_close').on( "click", function(){
    $('.arigato_list,.count').fadeOut(1000);
})
  
function readAloud() {
  // ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
  const text = document.getElementById("text").value;
  if ('speechSynthesis' in window) {
    // ç™ºè¨€ã‚’è¨­å®š
    const uttr = new SpeechSynthesisUtterance()
    uttr.text = text
    // ç™ºè¨€ã‚’å†ç”Ÿ
    window.speechSynthesis.speak(uttr)
  } 
}
$('#videoPlay').click(function(){
  const text = document.getElementById("text").value;
  const arigato = "ã‚ã‚ŠãŒã¨ã†"
  //console.log(text);
 if(text.indexOf(arigato) > -1) { 
    setTimeout(function(){
       const position = $('#videoPlay').offset().top;
       const speed = 600;
       $("html,body").animate({scrollTop:position},speed);
       var v = document.getElementById('video');
       v.play();
      $('.vid_contents').fadeIn(1000);
      $('.keep').fadeIn(1000);
    },3000);

    setTimeout(function(){
      $('.vid_contents').fadeOut(1000);
      }, 40000);

   // });
  } 
});



      //1.Save ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      $('#save').on("click", function () {
        var a = document.getElementById('audio');
     a.play();
      const key = new Date();
      const text_val = $('#text').val();

      // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚»ãƒƒãƒˆï¼ˆç™»éŒ²ï¼‰ã—ã¾ã™ğŸ¤—
      localStorage.setItem(key, text_val);

        var yy = key.getFullYear();
        // æœˆ(æœˆã®ãƒ‡ãƒ¼ã‚¿ã¯ã€Œï¼ï½ï¼‘ï¼‘ã€ãŒæ ¼ç´ã•ã‚Œã¦ã‚‹ã®ã§ï¼‘ã‚’è¶³ã—ã¦ã¾ã™)
        var mm = key.getMonth() + 1;
        // æ—¥ä»˜
        var dd = key.getDate().toString().padStart(2, '0');
        // æ™‚é–“
        var h = key.getHours().toString().padStart(2, '0');
        // åˆ†æ•°
        var m = key.getMinutes().toString().padStart(2, '0');
        var ima = ( yy + "å¹´" + mm + "æœˆ" + dd + "æ—¥" + " " + h + ":" + m );
        //console.log( yy + "å¹´" + mm + "æœˆ" + dd + "æ—¥" + " " + h + ":" + m );
         //$('#day'+ key).html(yy + "å¹´" + mm + "æœˆ" + dd + "æ—¥" + " " + h + ":" + m );
      

      // åŸ‹ã‚è¾¼ã¿ç”¨ã®htmlã®ã‚¿ã‚°ã¨å¤‰æ•°ã‚’ç´ã¥ã‘ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯
      // ES6ã§ç™»å ´ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«ã¨ã„ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã„ã¾ã™ğŸ¤—
      const html = `
        <li>
          <p class="day">${ima}</p>
          <p>${text_val}</p>
        </li>
      `;

      // html=ç”»é¢ã«è¡¨ç¤ºã—ã¾ã™ğŸ¤—
      $('#list').append(html)

      var size = $('#list li').length;
      console.log(size);
      if ( size === 0 ){
          // ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
        $('#list').after('<div class="cont"><span>ã‚ã‚ŠãŒã¨ã†</span>ã¯ã‚ã‚Šã¾ã›ã‚“</div>');
      } 

      // å…¥åŠ›ã‚’ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ç©ºæ¬„ã«ã™ã‚‹ğŸ¤—
      $('#text').val("");
      $('.keep').fadeOut(500);
      $('.arigato_list').fadeIn(1000);

      // ã“ã®ä¸‹ã¯æ¶ˆã•ãªã„
    });

    //2.clear ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    $('#clear').on('click', function () {
      //ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å…¨å‰Šé™¤ã™ã‚‹ğŸ¤—
      localStorage.clear();

      // ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹liã‚¿ã‚°ã‚’å‰Šé™¤=æŠ¹æ¶ˆ
      $('#list').empty();
      //$('.btn_area').fadeOut(1000);

      // ã“ã®ä¸‹æ¶ˆã•ãªã„
    });

    //3.ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ï¼šä¿å­˜ãƒ‡ãƒ¼ã‚¿å–å¾—è¡¨ç¤º
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      const value = localStorage.getItem(key);
      const jikan = new Date(key);

        var yy = jikan.getFullYear();
        // æœˆ(æœˆã®ãƒ‡ãƒ¼ã‚¿ã¯ã€Œï¼ï½ï¼‘ï¼‘ã€ãŒæ ¼ç´ã•ã‚Œã¦ã‚‹ã®ã§ï¼‘ã‚’è¶³ã—ã¦ã¾ã™)
        var mm = jikan.getMonth() + 1;
        // æ—¥ä»˜
        var dd = jikan.getDate().toString().padStart(2, '0');
        // æ™‚é–“
        var h = jikan.getHours().toString().padStart(2, '0');
        // åˆ†æ•°
        var m = jikan.getMinutes().toString().padStart(2, '0');
        var ima = ( yy + "å¹´" + mm + "æœˆ" + dd + "æ—¥" + " " + h + ":" + m );

      // htmlã®ã‚¿ã‚°ã¨å¤‰æ•°ã®åŸ‹ã‚è¾¼ã¿
      const html = `
        <li>
          <p class="day">${ima}</p>
          <p>${value}</p>
        </li>
      `;

      // ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
      $('#list').append(html);

      var size = $('#list li').length;
      console.log(size);
      if ( size === 0 ){
          // ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
        $('#list').after('<div class="cont"><span>ã‚ã‚ŠãŒã¨ã†</span>ã¯ã‚ã‚Šã¾ã›ã‚“</div>');
      } 

    }
    


  </script>
</body>

</html>